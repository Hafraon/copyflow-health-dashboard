# 🤖 НАЛАШТУВАННЯ TELEGRAM ALERT BOT ДЛЯ COPYFLOW DASHBOARD\n\n## 📋 **ПОКРОКОВА ІНСТРУКЦІЯ**\n\n### **🔧 КРОК 1: СТВОРИТИ TELEGRAM BOT**\n\n#### **1️⃣ Створити бота через BotFather:**\n1. **Відкрийте Telegram** і знайдіть **@BotFather** (@BotFather)\n2. **Відправте команду:** `/newbot`\n3. **Введіть назву бота:** `CopyFlow Alerts Bot`\n4. **Введіть username бота:** `copyflow_alerts_bot` (має закінчуватися на `_bot`)\n   - Якщо username зайнятий, спробуйте: `copyflow_health_bot` або `copyflow_monitor_bot`\n5. **BotFather дасть вам TOKEN** - збережіть його!\n\n**Приклад TOKEN:** `6234567890:AAHaABcDefghIJKLMNOPQRSTUVWXYZ1234567`\n\n#### **2️⃣ Налаштувати бота (опційно):**\nВідправте BotFather додаткові команди:\n```\n/setdescription - CopyFlow Health Monitoring Bot\n/setabouttext - Отримання сповіщень про статус системи CopyFlow\n```\n\n---\n\n### **🔍 КРОК 2: ОТРИМАТИ CHAT ID**\n\n#### **Варіант А: Особисті повідомлення**\n1. **Знайдіть свого бота** в Telegram за username\n2. **Відправте боту повідомлення:** `/start` або будь-який текст\n3. **Перейдіть в браузері за адресою:**\n   ```\n   https://api.telegram.org/bot{YOUR_BOT_TOKEN}/getUpdates\n   ```\n   Замініть `{YOUR_BOT_TOKEN}` на ваш справжній токен\n\n4. **У відповіді знайдіть:**\n   ```json\n   {\n     \"message\": {\n       \"chat\": {\n         \"id\": 123456789,  ← ЦЕ ВАШ CHAT_ID\n         \"type\": \"private\"\n       }\n     }\n   }\n   ```\n\n#### **Варіант Б: Групові повідомлення**\n1. **Створіть групу** в Telegram\n2. **Додайте бота** в групу\n3. **Відправте повідомлення** в групу\n4. **Перевірте getUpdates** - Chat ID буде від'ємним числом\n\n---\n\n### **⚙️ КРОК 3: НАЛАШТУВАТИ ЗМІННІ В RAILWAY**\n\nДодайте змінні в Railway Dashboard:\n\n```env\nTELEGRAM_BOT_TOKEN=6234567890:AAHaABcDefghIJKLMNOPQRSTUVWXYZ1234567\nTELEGRAM_CHAT_ID=123456789\n```\n\n#### **📋 Як додати в Railway:**\n1. Відкрийте ваш проект в Railway\n2. Перейдіть в **Variables** tab\n3. Натисніть **New Variable**\n4. Додайте обидві змінні\n5. **Deploy** проект знову\n\n---\n\n### **🧪 КРОК 4: ПРОТЕСТУВАТИ БОТА**\n\n#### **1️⃣ Через Dashboard UI:**\n1. Відкрийте ваш Dashboard\n2. Прокрутіть до **Quick Actions**\n3. Натисніть **Test Telegram**\n4. Перевірте результат\n\n#### **2️⃣ Через API безпосередньо:**\n```bash\ncurl -X POST https://your-dashboard.railway.app/api/telegram \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"action\": \"test\"}'\n```\n\n#### **3️⃣ Перевірити статус:**\n```bash\ncurl https://your-dashboard.railway.app/api/telegram\n```\n\n---\n\n### **📱 КРОК 5: НАЛАШТУВАТИ ALERTS**\n\nТепер ваш бот автоматично відправлятиме повідомлення коли:\n- **Response time** перевищить поріг\n- **Success rate** впаде нижче норми\n- **Сервіси** стануть недоступними\n- **Критичні помилки** в системі\n\n---\n\n## **📋 ПЕРЕВІРКА НАЛАШТУВАННЯ**\n\n### **✅ Контрольний список:**\n- [ ] BotFather створив бота і дав TOKEN\n- [ ] Відправили боту `/start` команду\n- [ ] Отримали Chat ID через getUpdates\n- [ ] Додали обидві змінні в Railway\n- [ ] Задеплоїли проект після додавання змінних\n- [ ] Тест через Dashboard показує success\n- [ ] Бот відправив тестове повідомлення\n\n---\n\n## **🚨 TROUBLESHOOTING**\n\n### **❌ Проблема: \"Bot token missing\"**\n**Рішення:**\n- Перевірте що `TELEGRAM_BOT_TOKEN` правильно вказаний\n- TOKEN має починатися з цифр, потім `:`, потім більше символів\n- Після додавання змінних обов'язково redeploy\n\n### **❌ Проблема: \"Chat ID missing\"**\n**Рішення:**\n- Переконайтесь що відправили боту повідомлення\n- Chat ID має бути числом (позитивним для приватних чатів)\n- Для груп Chat ID буде від'ємним числом\n\n### **❌ Проблема: \"403 Forbidden\"**\n**Рішення:**\n- Бот заблокований користувачем - розблокуйте бота\n- Неправильний Chat ID - отримайте заново\n- Бот видалений з групи - додайте знову\n\n### **❌ Проблема: \"Test відправляється але не приходить\"**\n**Рішення:**\n- Перевірте Chat ID через getUpdates\n- Переконайтесь що бот не заблокований\n- Спробуйте відправити `/start` боту ще раз\n\n---\n\n## **📊 ТИПИ ПОВІДОМЛЕНЬ ЩО НАДСИЛАЄ БОТ**\n\n### **🚨 Critical Alerts:**\n- Система недоступна >5 хвилин\n- Database connection failed\n- OpenAI API down\n- Success rate <90%\n\n### **⚠️ Warning Alerts:**\n- Response time >2 секунд\n- Success rate 90-95%\n- High error rate 5-10%\n\n### **ℹ️ Info Notifications:**\n- System recovery\n- Scheduled maintenance\n- Manual tests\n\n---\n\n## **🎨 ПРИКЛАД ПОВІДОМЛЕННЯ**\n\n```\n🚨 CopyFlow Alert ❤️\n\n🏷️ Сервіс: monitoring\n📋 Проблема: Response Time Alert\n📝 Деталі: averageResponseTime threshold exceeded: 3200 gt 2000\n⏰ Час: 08.08.2025, 14:30\n🎯 Рівень: WARNING\n\n📊 Дані:\n• averageResponseTime: 3200\n• Поріг: 2000\n\n🔗 Відкрити Dashboard\n```\n\n---\n\n**🎯 Готово! Тепер ви отримуватимете сповіщення про всі важливі події в CopyFlow!**\n